/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x5b8809,Plugin as _0x50ae2e}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x1e484b,MenuBarMenuListItemButtonView as _0x2626f5,SpinnerView as _0x12f0da,Notification as _0x1701d4}from'@ckeditor/ckeditor5-ui/dist/index.js';import{logWarning as _0x55012e}from'@ckeditor/ckeditor5-utils/dist/index.js';function f(){const _0x3efa5e=[],_0xd1b683=[];for(const _0x19f5d1 of Array['from'](document['styleSheets'])){if(_0x19f5d1['ownerNode']['hasAttribute']('data-cke')){for(const _0xda3eab of Array['from'](_0x19f5d1['cssRules']))-0x1!==_0xda3eab['cssText']['indexOf']('.ck-content')?_0x3efa5e['push'](_0xda3eab['cssText']):-0x1!==_0xda3eab['cssText']['indexOf'](':root')&&_0xd1b683['push'](_0xda3eab['cssText']);}}return _0x3efa5e['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0xd1b683,..._0x3efa5e]['join']('\x20')['trim']();}function a(_0x4cb9db,_0x575f61={}){const _0x119059=_0x4cb9db['plugins']['has']('Users'),_0x5d6173=_0x4cb9db['plugins']['has']('CommentsRepository'),_0x45a7eb=_0x4cb9db['plugins']['has']('TrackChanges'),_0x37317a=_0x575f61;if(_0x119059&&_0x5d6173){const _0x45427f=function(_0x1d1c74){const _0x13b7d0={};if(!_0x1d1c74['length'])return _0x13b7d0;for(const _0x14e5d7 of _0x1d1c74)_0x14e5d7['comments']['map'](_0x34af0e=>{void 0x0===_0x13b7d0[_0x14e5d7['id']]&&(_0x13b7d0[_0x14e5d7['id']]=[]),_0x13b7d0[_0x14e5d7['id']]['push']({'author':_0x34af0e['author']['name'],'content':_0x34af0e['content'],'created':_0x34af0e['createdAt'],'is_resolved':_0x14e5d7['isResolved']});});return _0x13b7d0;}(_0x4cb9db['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));Object['keys'](_0x45427f)['length']&&(_0x37317a['comments']=_0x45427f);}if(_0x119059&&_0x45a7eb){const _0xfc46f5=_0x4cb9db['plugins']['get']('TrackChanges'),_0x5a89e4=_0x4cb9db['plugins']['get']('Users'),_0xa0a50f=function(_0x34c3c7,_0x5d3f30){const _0x3a8f86={};if(!_0x34c3c7['length']||!_0x5d3f30['length'])return _0x3a8f86;for(const {id:_0x5edd9c,createdAt:_0x572387,authorId:_0x2fc528,attributes:_0xc01d66}of _0x34c3c7){const _0x5b2743=_0xc01d66&&_0xc01d66['@external'],_0x962c3d=_0x5b2743?_0x5b2743['authorName']:_0x5d3f30['get'](_0x2fc528)['name'];_0x3a8f86[_0x5edd9c]={'author':_0x962c3d,'created':_0x572387};}return _0x3a8f86;}(_0xfc46f5['getSuggestions']({'toJSON':!0x0}),_0x5a89e4['users']);Object['keys'](_0xa0a50f)['length']&&(_0x37317a['suggestions']=_0xa0a50f);}return(_0x37317a['suggestions']||_0x37317a['comments'])&&(_0x37317a['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone']),_0x37317a;}function m(_0xf8b215,_0x5555b0={}){const _0x329c4e=_0xf8b215['plugins']['has']('Users'),_0x307ef5=_0xf8b215['plugins']['has']('CommentsRepository'),_0x34a518=_0xf8b215['plugins']['has']('TrackChanges'),_0x4fe301=_0xf8b215['plugins']['has']('MergeFields'),_0x2332d0=_0xf8b215['locale']['contentLanguage'],_0x592d57=_0x5555b0,_0x101754={};if(_0x592d57['document']=_0x592d57['document']||{},_0x592d57['document']['language']=_0x592d57['document']['language']||_0x2332d0,_0x329c4e&&_0x307ef5){const _0x5e82ef=function(_0x44fff8){const _0x1b63bd=[];if(!_0x44fff8['length'])return _0x1b63bd;for(const _0x59589e of _0x44fff8){const _0x1b9d15=_0x59589e['comments']['map'](_0xee061a=>({'author':_0xee061a['author']['name'],'content':_0xee061a['content'],'created_at':_0xee061a['createdAt']}));_0x1b63bd['push']({'thread_id':_0x59589e['id'],'is_resolved':_0x59589e['isResolved'],'comments':_0x1b9d15});}return _0x1b63bd;}(_0xf8b215['plugins']['get']('CommentsRepository')['getCommentThreads']({'skipNotAttached':!0x0,'skipEmpty':!0x0}));_0x5e82ef['length']&&(_0x101754['comment_threads']=_0x5e82ef);}if(_0x329c4e&&_0x34a518){const _0xec5df3=_0xf8b215['plugins']['get']('TrackChanges'),_0x163a5e=_0xf8b215['plugins']['get']('Users'),_0x4cfd04=function(_0x21d83b,_0x45157a){if(!_0x21d83b['length']||!_0x45157a['length'])return[];return _0x21d83b['map'](({id:_0x61f41b,createdAt:_0x645119,authorId:_0x33b2f3,attributes:_0x2ec014})=>{const _0x284615=_0x2ec014&&_0x2ec014['@external'];return{'id':_0x61f41b,'author':_0x284615?_0x284615['authorName']:_0x45157a['get'](_0x33b2f3)['name'],'created_at':_0x645119};});}(_0xec5df3['getSuggestions']({'toJSON':!0x0}),_0x163a5e['users']);_0x4cfd04['length']&&(_0x101754['suggestions']=_0x4cfd04);}if(_0x4fe301){const _0x4a6ce6=_0xf8b215['plugins']['get']('MergeFieldsEditing'),_0x151dce=_0x4a6ce6['previewMode'],{prefix:_0x4fe795,suffix:_0x11ca78}=_0xf8b215['config']['get']('mergeFields');if(_0x592d57['merge_fields']={'prefix':_0x4fe795,'suffix':_0x11ca78},'$labels'!==_0x151dce){_0x592d57['merge_fields']['data']={};const _0x533b30='$defaultValues'===_0x151dce?_0x4a6ce6['getDefaultValues']():_0x4a6ce6['getDataSetValues'](_0x151dce,!0x0);for(const _0xccaf43 of Object['entries'](_0x533b30)){const [_0x198cc6,_0x499006]=_0xccaf43;_0x592d57['merge_fields']['data'][_0x198cc6]=null!==_0x499006?_0x499006:_0x4a6ce6['getLabel'](_0x198cc6);}}}return(_0x101754['comment_threads']||_0x101754['suggestions'])&&(_0x592d57['timezone']=new Intl['DateTimeFormat']()['resolvedOptions']()['timeZone'],_0x592d57['collaboration_features']=_0x101754),_0x592d57;}function p(_0x483bcc,_0x1ae771){const t=_0x483bcc['t'];switch(_0x1ae771){case'Export\x20to\x20Word':return t('Export\x20to\x20Word');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.');case'Word\x20document\x20export\x20started':return t('Word\x20document\x20export\x20started');case'Word\x20document\x20export\x20failed':return t('Word\x20document\x20export\x20failed');case'Word\x20document\x20export\x20successful':return t('Word\x20document\x20export\x20successful');case'Exporting\x20Word\x20document':return t('Exporting\x20Word\x20document');default:return _0x1ae771;}}const h=['orientation','margin_top','margin_right','margin_bottom','margin_left','format','header','footer','comments','suggestions'];class e extends _0x5b8809{constructor(_0x5bad21){super(_0x5bad21),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x1a0da4={}){const _0x5dc7d5=this['editor'],_0x10b5f4=_0x1a0da4['version']||0x2,_0x57b5c3=0x1===_0x10b5f4,_0x33411e=_0x1a0da4['converterUrl']||(_0x57b5c3?'https://docx-converter.cke-cs.com/v1/convert':'https://docx-converter.cke-cs.com/v2/convert/html-docx'),_0x5593e7=_0x1a0da4['converterOptions']||{},_0x449904=_0x5dc7d5['plugins']['get']('ExportWord'),_0x1ea366=_0x1a0da4['token']||_0x449904['_token'],_0x24aafb=!0x0===_0x5593e7['auto_pagination'],_0x585ffb=_0x1a0da4['dataCallback']||(_0x3099d4=>_0x3099d4['data']['get']({'pagination':_0x24aafb}));return 0x2===_0x10b5f4&&function(_0x271fcb){for(const _0x21c6b8 of h)if(void 0x0!==_0x271fcb[_0x21c6b8])return!0x0;return!0x1;}(_0x5593e7)&&_0x55012e('export-word-v1-api-is-deprecated'),this['isBusy']=!0x0,this['refresh'](),function(_0x551ff1){if(!_0x551ff1)return new Promise(_0x2125b2=>_0x2125b2(''));const _0x5e6a97=[];for(const _0x19f5ec of _0x551ff1)'EDITOR_STYLES'!==_0x19f5ec?_0x5e6a97['push'](window['fetch'](_0x19f5ec)['then'](_0x5b2e79=>_0x5b2e79['text']())):_0x5e6a97['push'](f());return Promise['all'](_0x5e6a97)['then'](_0x329080=>_0x329080['join']('\x20')['trim']());}(_0x1a0da4['stylesheets']||['EDITOR_STYLES'])['then'](async _0x4afcb2=>{_0x5dc7d5['ui']['ariaLiveAnnouncer']['announce'](p(_0x5dc7d5['locale'],'Word\x20document\x20export\x20started'));const _0x5d15db=await _0x585ffb(_0x5dc7d5),_0x5da6b6={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x5dc7d5['locale']['contentLanguageDirection']+'\x22>'+_0x5d15db+'</div>','css':_0x4afcb2,[_0x57b5c3?'options':'config']:{..._0x5593e7,..._0x57b5c3?a(_0x5dc7d5,_0x5593e7):m(_0x5dc7d5,_0x5593e7)}},_0xfa2726={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x1ea366?{'Authorization':_0x1ea366['value']}:null},'body':JSON['stringify'](_0x5da6b6)};return window['fetch'](_0x33411e,_0xfa2726)['then'](_0x2098e9=>{if(0xc8!==_0x2098e9['status'])throw _0x2098e9;return _0x2098e9['blob']();})['then'](_0x3d1793=>{_0x5dc7d5['ui']['ariaLiveAnnouncer']['announce'](p(_0x5dc7d5['locale'],'Word\x20document\x20export\x20successful'));const _0x16ebb7='function'==typeof _0x1a0da4['fileName']?_0x1a0da4['fileName']():_0x1a0da4['fileName'];this['_downloadFile'](_0x3d1793,_0x16ebb7||'document.docx');});})['catch'](_0x272093=>{const _0x35713c=_0x5dc7d5['plugins']['get']('Notification');throw _0x5dc7d5['ui']['ariaLiveAnnouncer']['announce'](p(_0x5dc7d5['locale'],'Word\x20document\x20export\x20failed'),{'politeness':'assertive'}),_0x35713c['showWarning'](p(_0x5dc7d5['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x272093;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x47aba2,_0x58e692){const _0x110516=document['createElement']('a');_0x110516['href']=window['URL']['createObjectURL'](_0x47aba2),_0x110516['download']=_0x58e692,_0x110516['click'](),_0x110516['remove']();}}class o extends _0x50ae2e{static get['pluginName'](){return'ExportWordUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x60b77b=this['editor'];_0x60b77b['ui']['componentFactory']['add']('exportWord',()=>{const _0x24991b=_0x60b77b['commands']['get']('exportWord'),_0x2cf1bf=this['_createButton'](_0x1e484b);return _0x2cf1bf['set']({'tooltip':!0x0}),_0x2cf1bf['bind']('isOn')['to'](_0x24991b,'isBusy'),_0x2cf1bf;}),_0x60b77b['ui']['componentFactory']['add']('menuBar:exportWord',()=>this['_createButton'](_0x2626f5));}['_createButton'](_0x318c47){const _0x4896e5=this['editor'],_0x1a8c33=_0x4896e5['config']['get']('exportWord')||{},_0x357437=_0x4896e5['commands']['get']('exportWord'),_0x6a6f07=new _0x318c47(_0x4896e5['locale']),_0x2e1b41=new _0x12f0da();return _0x6a6f07['children']['add'](_0x2e1b41),_0x2e1b41['bind']('isVisible')['to'](_0x357437,'isBusy'),_0x6a6f07['iconView']['bind']('isVisible')['to'](_0x357437,'isBusy',_0x280d48=>!_0x280d48),_0x6a6f07['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M17.826\x2016.843a.75.75\x200\x200\x200-1.152-.96L15.5\x2017.29V12H14v5.29l-1.174-1.408a.75.75\x200\x200\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22m14\x200\x205\x204.5v9.741a2.737\x202.737\x200\x200\x200-1.5-.617V6.5h-5v-5h-8v3H3V0h11Zm0\x202v3h3.3L14\x202Z\x22/><path\x20d=\x22M3\x2017.5h6.746c.1.22.23.429.391.623l.731.877H3v-1.5Z\x22/><path\x20d=\x22M8.5\x206a1.5\x201.5\x200\x200\x201\x201.493\x201.356L10\x207.5v7a1.5\x201.5\x200\x200\x201-1.356\x201.493L8.5\x2016h-7a1.5\x201.5\x200\x200\x201-1.493-1.356L0\x2014.5v-7a1.5\x201.5\x200\x200\x201\x201.356-1.493L1.5\x206h7ZM7.483\x208.795l-.042.088-.986\x202.534-.947-2.528-.043-.092a.601.601\x200\x200\x200-1.042.008l-.042.093-.883\x202.465-.937-2.475-.042-.089a.6.6\x200\x200\x200-1.107.42l.027.093\x201.514\x204\x20.044.092a.6.6\x200\x200\x200\x201.041-.01l.041-.092.88-2.458.925\x202.467.046.096a.6.6\x200\x200\x200\x201.032\x200l.043-.09\x201.554-4\x20.028-.093a.6.6\x200\x200\x200-1.104-.43v.001Z\x22/></svg>\x0a'}),_0x6a6f07['bind']('isEnabled')['to'](_0x357437,'isEnabled'),_0x6a6f07['bind']('label')['to'](_0x357437,'isBusy',_0x23ab71=>p(_0x4896e5['locale'],_0x23ab71?'Exporting\x20Word\x20document':'Export\x20to\x20Word')),this['listenTo'](_0x6a6f07,'execute',()=>{_0x4896e5['execute']('exportWord',_0x1a8c33),_0x4896e5['editing']['view']['focus']();}),_0x6a6f07;}}class s extends _0x50ae2e{['_token'];static get['pluginName'](){return'ExportWord';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x1701d4,o];}['init'](){const _0x465c84=this['editor'],_0x4cc190=_0x465c84['config']['get']('exportWord')||{};_0x465c84['commands']['add']('exportWord',new e(_0x465c84));const _0x29cdf0=_0x465c84['plugins']['get']('CloudServices');!0x1===_0x4cc190['tokenUrl']?this['_token']=null:_0x4cc190['tokenUrl']?_0x29cdf0['registerTokenUrl'](_0x4cc190['tokenUrl'])['then'](_0x312de2=>{this['_token']=_0x312de2;}):this['_token']=_0x29cdf0['token'];}}export{s as ExportWord};