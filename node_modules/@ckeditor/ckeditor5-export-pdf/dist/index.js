/*
 *             Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x9f7fcd,Plugin as _0x395532}from'@ckeditor/ckeditor5-core/dist/index.js';import{ButtonView as _0x594d84,MenuBarMenuListItemButtonView as _0xf22339,SpinnerView as _0xd8f159,Notification as _0x1aaf97}from'@ckeditor/ckeditor5-ui/dist/index.js';function a(){const _0xe33ae=[],_0x2e8bba=[];for(const _0x3df7a7 of Array['from'](document['styleSheets'])){if(_0x3df7a7['ownerNode']['hasAttribute']('data-cke')){for(const _0x307cfe of Array['from'](_0x3df7a7['cssRules']))-0x1!==_0x307cfe['cssText']['indexOf']('.ck-content')?_0xe33ae['push'](_0x307cfe['cssText']):-0x1!==_0x307cfe['cssText']['indexOf'](':root')&&_0x2e8bba['push'](_0x307cfe['cssText']);}}return _0xe33ae['length']||console['warn']('The\x20editor\x20stylesheet\x20could\x20not\x20be\x20found\x20in\x20the\x20document.\x20Check\x20your\x20webpack\x20config\x20â€“\x20style-loader\x20should\x20use\x20data-cke=true\x20attribute\x20for\x20the\x20editor\x20stylesheet.'),[..._0x2e8bba,..._0xe33ae]['join']('\x20')['trim']();}function d(_0x112e0d,_0x5b4c87){const t=_0x112e0d['t'];switch(_0x5b4c87){case'Export\x20to\x20PDF':return t('Export\x20to\x20PDF');case'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.':return t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.');case'PDF\x20export\x20started':return t('PDF\x20export\x20started');case'PDF\x20export\x20failed':return t('PDF\x20export\x20failed');case'PDF\x20export\x20successful':return t('PDF\x20export\x20successful');case'Exporting\x20PDF\x20document':return t('Exporting\x20PDF\x20document');default:return _0x5b4c87;}}class e extends _0x9f7fcd{constructor(_0x4a4d1c){super(_0x4a4d1c),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x33394e={}){const _0x232d7b=this['editor'],_0x230ed7=_0x33394e['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x3a1f6a=_0x33394e['dataCallback']||(_0x11908d=>_0x11908d['data']['get']()),_0x5ac51f=_0x232d7b['plugins']['get']('ExportPdf'),_0x269d87=_0x33394e['token']||_0x5ac51f['_token'];return this['isBusy']=!0x0,this['refresh'](),function(_0x57f120){if(!_0x57f120)return new Promise(_0x582cce=>_0x582cce(''));const _0x159060=[];for(const _0x2d106d of _0x57f120)'EDITOR_STYLES'!==_0x2d106d?_0x159060['push'](window['fetch'](_0x2d106d)['then'](_0x54a712=>_0x54a712['text']())):_0x159060['push'](a());return Promise['all'](_0x159060)['then'](_0x2112b5=>_0x2112b5['join']('\x20')['trim']());}(_0x33394e['stylesheets']||['EDITOR_STYLES'])['then'](async _0x13e783=>{if(_0x232d7b['ui']['ariaLiveAnnouncer']['announce'](d(_0x232d7b['locale'],'PDF\x20export\x20started')),_0x232d7b['plugins']['has']('MergeFields')){_0x33394e['converterOptions']||(_0x33394e['converterOptions']={});const _0x3419e2=_0x232d7b['plugins']['get']('MergeFieldsEditing'),_0xaac1d8=_0x3419e2['previewMode'],{prefix:_0x7deceb,suffix:_0x347237}=_0x232d7b['config']['get']('mergeFields'),_0x1ece0b={'prefix':_0x7deceb,'suffix':_0x347237,'data':{}};if('$labels'===_0xaac1d8){for(const _0x51e884 of _0x3419e2['getMergeFieldsIds']())_0x1ece0b['data'][_0x51e884]=_0x7deceb+_0x3419e2['getLabel'](_0x51e884)+_0x347237;}else{const _0x109682='$defaultValues'===_0xaac1d8?_0x3419e2['getDefaultValues']():_0x3419e2['getDataSetValues'](_0xaac1d8,!0x0);for(const _0x5f5643 of Object['entries'](_0x109682)){const [_0xec06b4,_0x1973a3]=_0x5f5643;_0x1ece0b['data'][_0xec06b4]=null!==_0x1973a3?_0x1973a3:_0x3419e2['getLabel'](_0xec06b4);}}_0x33394e['converterOptions']['merge_fields']=_0x1ece0b;}const _0x501560={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x232d7b['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x3a1f6a(_0x232d7b)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x13e783,'options':_0x33394e['converterOptions']},_0x5265e1={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x269d87?{'Authorization':_0x269d87['value']}:null,'x-cs-app-id':_0x33394e['appID']||'cke5'},'body':JSON['stringify'](_0x501560)};return window['fetch'](_0x230ed7,_0x5265e1)['then'](_0x281307=>{if(0xc8!==_0x281307['status'])throw _0x281307;return _0x281307['blob']();})['then'](_0x35bd57=>{_0x232d7b['ui']['ariaLiveAnnouncer']['announce'](d(_0x232d7b['locale'],'PDF\x20export\x20successful'));const _0x3f1f46='function'==typeof _0x33394e['fileName']?_0x33394e['fileName']():_0x33394e['fileName'];this['_downloadFile'](_0x35bd57,_0x3f1f46||'document.pdf');});})['catch'](_0x456ed2=>{const _0x267409=_0x232d7b['plugins']['get']('Notification');throw _0x232d7b['ui']['ariaLiveAnnouncer']['announce'](d(_0x232d7b['locale'],'PDF\x20export\x20failed'),{'politeness':'assertive'}),_0x267409['showWarning'](d(_0x232d7b['locale'],'An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x456ed2;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0xd1f441,_0x304762){const _0x4bd8d6=document['createElement']('a');_0x4bd8d6['href']=window['URL']['createObjectURL'](_0xd1f441),_0x4bd8d6['download']=_0x304762,_0x4bd8d6['click'](),_0x4bd8d6['remove']();}}class s extends _0x395532{static get['pluginName'](){return'ExportPdfUI';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}['init'](){const _0x38c420=this['editor'];_0x38c420['ui']['componentFactory']['add']('exportPdf',()=>{const _0x5944f9=this['_createButton'](_0x594d84),_0x1dfa86=_0x38c420['commands']['get']('exportPdf');return _0x5944f9['set']({'tooltip':!0x0}),_0x5944f9['bind']('isOn')['to'](_0x1dfa86,'isBusy'),_0x5944f9;}),_0x38c420['ui']['componentFactory']['add']('menuBar:exportPdf',()=>this['_createButton'](_0xf22339));}['_createButton'](_0x197134){const _0x3d8a6a=this['editor'],_0x35210b=_0x3d8a6a['config']['get']('exportPdf')||{},_0x3db0d5=_0x3d8a6a['commands']['get']('exportPdf'),_0x93ab70=new _0x197134(_0x3d8a6a['locale']),_0x26fa70=new _0xd8f159();return _0x93ab70['children']['add'](_0x26fa70),_0x26fa70['bind']('isVisible')['to'](_0x3db0d5,'isBusy'),_0x93ab70['iconView']['bind']('isVisible')['to'](_0x3db0d5,'isBusy',_0x1746b4=>!_0x1746b4),_0x93ab70['set']({'icon':'<svg\x20viewBox=\x220\x200\x2020\x2020\x22\x20xmlns=\x22http://www.w3.org/2000/svg\x22><path\x20d=\x22M19\x204.5\x2014\x200H3v6.5h1.5v-5h8v5h5V11H19V4.5ZM14\x202l3.3\x203H14V2Z\x22/><path\x20d=\x22m12.452\x2018.5\x201.25\x201.5H3v-3h1.5v1.5h7.952Z\x22/><path\x20d=\x22M19.826\x2016.843a.75.75\x200\x201\x200-1.152-.96L17.5\x2017.29V13H16v4.29l-1.174-1.408a.75.75\x200\x201\x200-1.152.96l2.346\x202.816a.95.95\x200\x200\x200\x201.46\x200l2.346-2.815Z\x22/><path\x20d=\x22M1.63\x2014.24V12.3h.88c.66\x200\x201.14-.15\x201.46-.45.32-.3.48-.71.48-1.24\x200-.52-.15-.91-.44-1.2C3.7\x209.15\x203.28\x209\x202.69\x209H0v5.24h1.63Zm.4-3h-.4v-1.17h.46c.3\x200\x20.5.05.62.17.1.11.16.25.16.42\x200\x20.16-.06.3-.19.41-.13.11-.34.16-.66.16l.01.01Zm5.7\x203c.28\x200\x20.6-.05.96-.14.26-.07.5-.21.73-.42.22-.2.4-.47.53-.77.12-.31.19-.75.19-1.3\x200-.37-.04-.7-.13-1.02a2.3\x202.3\x200\x200\x200-.42-.84c-.19-.24-.43-.43-.72-.56C8.57\x209.06\x208.2\x209\x207.72\x209h-2.4v5.24H7.73Zm-.4-1.19h-.4v-2.86h.4c.43\x200\x20.73.1.91.3.18.2.27.59.27\x201.14\x200\x20.42-.04.73-.12.91a.76.76\x200\x200\x201-.34.4c-.14.07-.38.11-.72.11Zm5.3\x201.2V12.1h2.02v-1.06h-2.03v-.91H15V9h-4v5.24h1.62l.01.01Z\x22/></svg>\x0a'}),_0x93ab70['bind']('isEnabled')['to'](_0x3db0d5,'isEnabled'),_0x93ab70['bind']('label')['to'](_0x3db0d5,'isBusy',_0x137c27=>d(_0x3d8a6a['locale'],_0x137c27?'Exporting\x20PDF\x20document':'Export\x20to\x20PDF')),this['listenTo'](_0x93ab70,'execute',()=>{_0x3d8a6a['execute']('exportPdf',_0x35210b),_0x3d8a6a['editing']['view']['focus']();}),_0x93ab70;}}class o extends _0x395532{['_token'];static get['pluginName'](){return'ExportPdf';}static get['isOfficialPlugin'](){return!0x0;}static get['isPremiumPlugin'](){return!0x0;}static get['requires'](){return['CloudServices',_0x1aaf97,s];}['init'](){const _0x2eb782=this['editor'],_0x878472=_0x2eb782['config']['get']('exportPdf')||{};_0x2eb782['commands']['add']('exportPdf',new e(_0x2eb782));const _0x160064=_0x2eb782['plugins']['get']('CloudServices');!0x1===_0x878472['tokenUrl']?this['_token']=null:_0x878472['tokenUrl']?_0x160064['registerTokenUrl'](_0x878472['tokenUrl'])['then'](_0x37304a=>{this['_token']=_0x37304a;}):this['_token']=_0x160064['token'];}}export{o as ExportPdf};